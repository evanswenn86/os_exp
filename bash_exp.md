# Bash教程

## 1 模式扩展
前言：  
Shell 接收到用户输入的命令以后，会根据空格将用户的输入，拆分成一个个词元（token）。然后，Shell 会扩展词元里面的特殊字符，扩展完成后才会调用相应的命令。  
这种特殊字符的扩展，称为模式扩展（globbing）。其中有些用到通配符，又称为通配符扩展（wildcard expansion）。Bash 一共提供八种扩展。

+ 波浪线扩展
+ ? 字符扩展
+ *字符扩展
+ 方括号扩展
+ 大括号扩展
+ 变量扩展
+ 子命令扩展
+ 算术扩展

打开扩展与关闭扩展：

    关闭：
    $ set -o noglob
    # 或者
    $ set -f
    打开
    $ set +o noglob
    # 或者
    $ set +f

### 1.1 波浪线扩展
波浪线~会自动扩展成当前用户的主目录。

    $ echo ~
    >> /home/me


    $ echo ~foo
    >> /home/foo

    $ echo ~root
    >> /root

Bash 会根据波浪号后面的用户名，返回该用户的主目录。

~+会扩展成当前所在的目录，等同于pwd命令。

    $ cd ~/foo
    $ echo ~+
    >> /home/me/foo    

### 1.2 ?扩展
?字符代表文件路径里面的任意单个字符，不包括空字符。比如，Data???匹配所有Data后面跟着三个字符的文件名。

    $ ls ?.txt
    >> a.txt b.txt

上面命令中，?表示单个字符，所以会同时匹配a.txt和b.txt。
如果匹配多个字符，就需要多个?连用。

    $ ls ??.txt
    >> ab.txt

### 1.3 *扩展

*字符代表文件路径里面的任意数量的任意字符，包括零个字符。

    $ ls *.txt
    >> a.txt b.txt ab.txt

上面例子中，*.txt代表后缀名为.txt的所有文件。

如果想输出当前目录的所有文件，直接用*即可。

    $ ls *

如果要匹配隐藏文件，需要写成.*。

    $ echo .*

如果要匹配隐藏文件，同时要排除.和..这两个特殊的隐藏文件，可以与方括号扩展结合使用，写成.[!.]*。

    $ echo .[!.]*

*只匹配当前目录，不会匹配子目录。
    
    # 子目录有一个 a.txt
    # 无效的写法
    $ ls *.txt

    # 有效的写法
    $ ls */*.txt

上面的例子，文本文件在子目录，*.txt不会产生匹配，必须写成*/*.txt。有几层子目录，就必须写几层星号。

### 1.4 方括号扩展
方括号扩展的形式是[...]，只有文件确实存在的前提下才会扩展。如果文件不存在，就会原样输出。

    # 存在文件 a.txt 和 b.txt
    $ ls [ab].txt
    a.txt b.txt

    # 只存在文件 a.txt
    $ ls [ab].txt
    a.txt

方括号扩展还有两种变体：[^...]和[!...]。它们表示匹配不在方括号里面的字符，这两种写法是等价的。比如，[^abc]或[!abc]表示匹配除了a、b、c以外的字符。

    $ ls ?[!a]?
    aba bbb

### 1.5 [start-end] 扩展
方括号扩展有一个简写形式[start-end]，表示匹配一个连续的范围。比如，[a-c]等同于[abc]，[0-9]匹配[0123456789]。


    $ ls report[0-9].txt
    report1.txt
    report2.txt
    report3.txt

常用简写的例子：
+ [a-z]：所有小写字母。
+ [a-zA-Z]：所有小写字母与大写字母。
+ [a-zA-Z0-9]：所有小写字母、大写字母与数字。
+ [abc]*：所有以a、b、c字符之一开头的文件名。
+ program.[co]：文件program.c与文件program.o。
+ BACKUP.[0-9][0-9][0-9]：所有以BACKUP.开头，后面是三个数字的文件名。


这种简写形式有一个否定形式[!start-end]，表示匹配不属于这个范围的字符。比如，[!a-zA-Z]表示匹配非英文字母的字符。


### 1.6 大括号扩展
大括号扩展{...}表示分别扩展成大括号里面的所有值，各个值之间使用逗号分隔。比如，{1,2,3}扩展成1 2 3。

    $ echo Front-{A,B,C}-Back
    Front-A-Back Front-B-Back Front-C-Back

注意，大括号扩展不是文件名扩展。它会扩展成所有给定的值，而不管是否有对应的文件存在。  
逗号前面可以没有值，表示扩展的第一项为空。

    $ cp a.log{,.bak}

    # 等同于
    # cp a.log a.log.bak

大括号可以嵌套。

    $ echo {j{p,pe}g,png}
    jpg jpeg png

    $ echo a{A{1,2},B{3,4}}b
    aA1b aA2b aB3b aB4b

    $ echo {cat,d*}
    cat dawg dg dig dog doug dug

大括号扩展的常见用途为新建一系列目录。

    $ mkdir {2007..2009}-{01..12}

上面命令会新建36个子目录，每个子目录的名字都是”年份-月份“。

这个写法的另一个常见用途，是直接用于for循环。

    for i in {1..4}
        do
    echo $i
        done

简写形式还可以使用第二个双点号（start..end..step），用来指定扩展的步长。

    $ echo {0..8..2}
    >> 0 2 4 6 8



